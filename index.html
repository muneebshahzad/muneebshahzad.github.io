<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopify Last Order</title>
  </head>
  <body>
    <div>
      <h1>Last Order Number:</h1>
      <p id="orderNumber"></p>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", async function() {
        try {
          // Make a request to your serverless function
          const response = await fetch('/.netlify/functions/getLastOrder');
          const result = await response.json();
          // Update the UI with the received data
          document.getElementById('orderNumber').innerText = result.lastOrderNumber;
        } catch (error) {
          console.error('Error:', error.message);
        }
      });
    </script>
    <script>
      // getLastOrder.js
      async function getLastOrder() {
        try {
          // Replace 'YOUR_ADMIN_API_ACCESS_TOKEN' with your actual Admin API access token
          const adminApiAccessToken = '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';
          // Make request to Shopify Admin API
          const response = await fetch('https://alkaramat.myshopify.com/admin/api/2022-01/orders.json', {
            headers: {
              'X-Shopify-Access-Token': adminApiAccessToken,
            },
          });
          // Extract relevant data from the response
          const result = await response.json();
          const lastOrderNumber = result.orders[0].order_number;
          // Send the data back
          return {
            statusCode: 200,
            body: JSON.stringify({
              lastOrderNumber
            }),
          };
        } catch (error) {
          console.error('Error:', error.message);
          return {
            statusCode: 500,
            body: JSON.stringify({
              error: 'Internal Server Error'
            }),
          };
        }
      }
      // Uncomment the next line to test the function
      // getLastOrder().then(result => console.log(result));
    </script>
  </body>
</html>
