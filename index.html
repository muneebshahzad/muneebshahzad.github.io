<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brand Names</title>
</head>
<body>
    <h1>Brand Names</h1>
    <p>This webpage will display the brand names obtained from Daraz.</p>

    <script>
        // Function to extract the authentication token from the URL query parameters
        function getAuthTokenFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('code');
        }

        // Function to display the brand names on the webpage
        async function displayBrandNames() {
            const authToken = getAuthTokenFromURL();
            if (authToken) {
                const tokenEndpoint = 'https://api.daraz.pk/auth/token/create';
                const tokenRequestPayload = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        'grant_type': 'authorization_code',
                        'code': authToken,
                        'redirect_uri': 'https://muneebshahzad.github.io',
                        'client_id': '501554',
                        'client_secret': 'nrP3XFN7ChZL53cXyVED1yj4iGZZtlcD'
                    })
                };

                // Request access token using the authorization code
                const tokenResponse = await fetch(tokenEndpoint, tokenRequestPayload);
                const tokenData = await tokenResponse.json();

                // Extract the access token from the token response
                const accessToken = tokenData.access_token;

                // Make request to /brands/get endpoint using the access token
                const brandsEndpoint = 'https://api.daraz.pk/rest/brands/get';
                const brandsRequestPayload = {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`
                    }
                };

                // Request brand names
                const brandsResponse = await fetch(brandsEndpoint, brandsRequestPayload);
                const brandsData = await brandsResponse.json();

                // Display brand names
                const brandNames = brandsData.data.map(brand => brand.name).join(', ');
                document.getElementById('brandNames').innerText = brandNames;
            } else {
                document.getElementById('brandNames').innerText = 'Authentication token not found in URL.';
            }
        }

        // Call the function to display the brand names when the page loads
        window.onload = displayBrandNames;
    </script>

    <p>Brand Names: <span id="brandNames"></span></p>
</body>
</html>
